@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* ==== â˜€ï¸ äº®è‰²æ¨¡å¼ (Light Mode) ==== */
    --bg-canvas: #f0f2f5;
    --bg-grid-minor: #e2e8f0;
    --bg-grid-major: #cbd5e1;

    --node-header: #ffffff;
    --node-body: #f8fafc;
    --node-border: #cbd5e1;

    --widget-bg: #e2e8f0;
    --widget-hover: #cbd5e1;

    --text-head: #1e293b;
    --text-label: #64748b;
    --text-val: #0f172a;
    --text-sub: #94a3b8;

    --edge-stroke: #94a3b8;

    /* æ§åˆ¶å°é…è‰² (äº®è‰²) */
    --console-bg: #ffffff;
    --console-border: #e2e8f0;
    --console-text: #334155;
    --console-info: #0ea5e9;
  }

  .dark {
    /* ==== ğŸŒ™ æ·±è‰²æ¨¡å¼ (ComfyUI Style) ==== */
    --bg-canvas: #202020;
    --bg-grid-minor: #2a2a2a;
    --bg-grid-major: #000000;

    --node-header: #353535;
    --node-body: #3b3b3b;
    --node-border: #2a2a2a;

    --widget-bg: #222;
    --widget-hover: #333;

    --text-head: #eee;
    --text-label: #aaa;
    --text-val: #fff;
    --text-sub: #777;

    --edge-stroke: #777;

    /* æ§åˆ¶å°é…è‰² (æ·±è‰²) - æé»‘ */
    --console-bg: #0f0f0f;
    --console-border: #333333;
    --console-text: #cccccc;
    --console-info: #60a5fa;
  }
}

body {
  background-color: var(--bg-canvas);
  color: var(--text-head);
  font-family: 'Segoe UI', Roboto, sans-serif;
  overflow: hidden;
  transition: background-color 0.2s;
}

/* === React Flow Overrides === */

/* 1. Handle (è¿æ¥ç‚¹) */
.react-flow__handle {
  border-radius: 50%;
  border: none !important;
  box-shadow: 0 0 2px rgba(0,0,0,0.8);
}
.react-flow__handle:hover {
  box-shadow: 0 0 0 2px white;
}

/* 2. Edge (è¿çº¿) */
.react-flow__edge-path {
  stroke: var(--edge-stroke) !important;
  opacity: 0.7;
  stroke-width: 2px;
}
.react-flow__edge.selected .react-flow__edge-path {
  stroke: #fff !important;
  opacity: 1;
  stroke-width: 3px !important;
}

/* 3. Node Selection (é€‰ä¸­æ¡†) */
.react-flow__node.selected .node-wrapper {
  border: 1px solid #fff !important;
}
.react-flow__node.selected {
  outline: none !important;
}

/* === ComfyUI é£æ ¼é¼ æ ‡äº¤äº’ (å¼ºåˆ¶ç®­å¤´) === */
/* æ ¸å¿ƒåŸç†ï¼šè¦†ç›– React Flow é»˜è®¤çš„ grab/grabbing å…‰æ ‡ */

/* ç”»å¸ƒé»˜è®¤çŠ¶æ€ */
.react-flow__pane {
  cursor: default !important;
}

/* å½“æŒ‰ä½é¼ æ ‡è¿›è¡Œå¹³ç§»æ—¶ï¼Œå¼ºåˆ¶ä¿æŒç®­å¤´ï¼Œä¸è¦å˜æˆæŠ“æ‰‹ */
.react-flow__pane.panning,
.react-flow__viewport.panning {
  cursor: default !important;
}

/* èŠ‚ç‚¹é»˜è®¤å¯ä»¥æ‹–æ‹½ï¼Œé¼ æ ‡æ”¾ä¸Šå»æ˜¯ç§»åŠ¨å›¾æ ‡ */
.react-flow__node {
    cursor: move;
}

/* === MiniMap æ ·å¼å¢å¼º (æ˜¾ç¤ºè¿çº¿) === */

/* å°åœ°å›¾èƒŒæ™¯ */
.react-flow__minimap {
  background-color: var(--bg-canvas) !important;
}

/* å°åœ°å›¾èŠ‚ç‚¹é¢œè‰² (è™½ç„¶JSé‡Œè®¾ç½®äº†ï¼Œè¿™é‡Œå…œåº•) */
.react-flow__minimap-node {
  fill: #3b82f6 !important;
  stroke: none;
}

/* ã€å…³é”®æ–°å¢ã€‘å°åœ°å›¾è¿çº¿é¢œè‰² */
.react-flow__minimap-edge {
  stroke: var(--edge-stroke) !important;
  stroke-width: 2px;
  opacity: 0.6;
}

/* éšè— type="number" çš„é»˜è®¤ç®­å¤´ */
.no-spinners::-webkit-inner-spin-button,
.no-spinners::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* src/index.css */

/* è‡ªå®šä¹‰æ»šåŠ¨æ¡ - ä»¿ ComfyUI é£æ ¼ */
.custom-scrollbar::-webkit-scrollbar {
  width: 8px; /* ç¨å¾®å®½ä¸€ç‚¹ï¼Œæ–¹ä¾¿ç‚¹å‡» */
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: #1a1a1a; /* è½¨é“ææ·±è‰² */
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: #444; /* æ»šåŠ¨æ¡æ·±ç°è‰² */
  border-radius: 4px;
  border: 2px solid #1a1a1a; /* ç»™ä¸ªè¾¹æ¡†è®©å®ƒçœ‹èµ·æ¥åƒæ‚¬æµ®åœ¨ä¸­é—´ */
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: #666; /* æ‚¬åœå˜äº® */
}

/* å®šä¹‰æµåŠ¨åŠ¨ç”»å…³é”®å¸§ */
@keyframes dashdraw {
  from {
    stroke-dashoffset: 20;
  }
  to {
    stroke-dashoffset: 0;
  }
}

/* æ¿€æ´»çŠ¶æ€çš„è¿çº¿ï¼šå˜æˆè“è‰²æµåŠ¨è™šçº¿ */
.react-flow__edge.animated path {
  stroke: #3b82f6 !important; /* äº®è“è‰² */
  stroke-width: 3px !important;
  stroke-dasharray: 10; /* è™šçº¿é—´éš” */
  animation: dashdraw 0.5s linear infinite !important; /* è¶…é«˜é€ŸæµåŠ¨ */
  opacity: 1 !important;
}

/* èŠ‚ç‚¹è¿è¡Œæ—¶çš„å‘¼å¸æ•ˆæœ (å¯é€‰) */
.node-running-pulse {
  animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
}

@keyframes pulse-ring {
  0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
  70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
  100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
}

/* 1. å½“å¼€å§‹è¿çº¿æ—¶ï¼Œè®©æ‰€æœ‰å¯èƒ½çš„è¿æ¥ç‚¹å˜å¤§ä¸€ç‚¹ï¼Œæç¤ºç”¨æˆ·â€œæ’è¿™é‡Œâ€ */
.react-flow__handle.connecting {
  width: 12px !important;
  height: 12px !important;
  transition: all 0.2s;
  background-color: #aaa; /* é»˜è®¤å˜ç° */
}

/* 2. è¿™é‡Œçš„é€»è¾‘éœ€è¦ JS é…åˆï¼š
   React Flow é»˜è®¤åªä¼šæ ‡è®° connectingã€‚
   å¦‚æœä½ æƒ³åš "çº¢/ç»¿" åŒºåˆ†ï¼Œæœ€ç®€å•çš„åŠæ³•æ˜¯åˆ©ç”¨ validHandleFunc
   æˆ–è€…ä½¿ç”¨ React Flow çš„ Connection Line Componentï¼Œ
   ä½†è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ª CSS Hack æŠ€å·§ã€‚
*/

/* è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„â€œå…è®¸è¿æ¥â€æ ·å¼ (å‡è®¾å®ƒæ˜¯æœ‰æ•ˆçš„) */
.react-flow__handle.connecting:hover {
  background-color: #22c55e !important; /* ç»¿è‰² */
  box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.4);
  transform: scale(1.2);
}